---
title: 2ã€Javaåºåˆ—åŒ–å¼•å‘çš„è¡€æ¡ˆ
--- 

## 1ã€å¼•è¨€

é˜¿é‡Œå·´å·´Javaå¼€å‘æ‰‹å†Œåœ¨ç¬¬ä¸€ç« èŠ‚ï¼Œç¼–ç¨‹è§„çº¦ä¸­OOPè§„çº¦çš„ç¬¬15æ¡æåˆ°ï¼š

> **ã€å¼ºåˆ¶ã€‘**åºåˆ—åŒ–ç±»æ–°å¢å±æ€§æ—¶ï¼Œè¯·ä¸è¦ä¿®æ”¹serialVersionUIDå­—æ®µï¼Œé¿å…ååºåˆ—å¤±è´¥ï¼›å¦‚æœå®Œå…¨ä¸å…¼å®¹å‡çº§ï¼Œé¿å…ååºåˆ—åŒ–æ··ä¹±ï¼Œé‚£ä¹ˆè¯·ä¿®æ”¹serialVersionUIDå€¼ã€‚
>
> è¯´æ˜ï¼šæ³¨æ„serialVersionUIDä¸ä¸€è‡´ä¼šæŠ›å‡ºåºåˆ—åŒ–è¿è¡Œæ—¶å¼‚å¸¸

å¦‚æœæ²¡æ¥è§¦è¿‡åºåˆ—åŒ–çš„äººï¼Œåº”è¯¥ä¼šæœ‰ä»¥ä¸‹ç–‘é—®ï¼š

- åºåˆ—åŒ–å’Œååºåˆ—åŒ–åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ
- å®ƒçš„ä¸»è¦ä½¿ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ
- Java åºåˆ—åŒ–å¸¸è§çš„æ–¹æ¡ˆæœ‰å“ªäº›ï¼Ÿ
- å„ç§å¸¸è§åºåˆ—åŒ–æ–¹æ¡ˆçš„åŒºåˆ«æœ‰å“ªäº›ï¼Ÿ
- å®é™…çš„ä¸šåŠ¡å¼€å‘ä¸­æœ‰å“ªäº›å‘ç‚¹ï¼Ÿ

## 2ã€ä»€ä¹ˆæ˜¯åºåˆ—åŒ–å’Œååºåˆ—åŒ–

> **åºåˆ—åŒ–**æ˜¯å°†å†…å­˜ä¸­çš„å¯¹è±¡ä¿¡æ¯è½¬åŒ–æˆå¯ä»¥å­˜å‚¨æˆ–è€…ä¼ è¾“çš„æ•°æ®åˆ°ä¸´æ—¶æˆ–æ°¸ä¹…å­˜å‚¨çš„è¿‡ç¨‹ã€‚åœ¨Javaä¸­å…¶å®å°±æ˜¯æŠŠJavaå¯¹è±¡è½¬æ¢ä¸ºäºŒè¿›åˆ¶å†…å®¹ï¼Œå…¶æœ¬è´¨å°±æ˜¯ä¸€ä¸ªbyte[]æ•°ç»„
> **ååºåˆ—åŒ–**æ˜¯ä»ä¸´æ—¶æˆ–æ°¸ä¹…å­˜å‚¨ä¸­è¯»å–åºåˆ—åŒ–çš„æ•°æ®å¹¶è½¬åŒ–æˆå†…å­˜å¯¹è±¡çš„è¿‡ç¨‹ã€‚åœ¨Javaä¸­å°±æ˜¯å°†ä¸€ä¸ªbyte[]è½¬æ¢ä¸ºJavaå¯¹è±¡çš„è¿‡ç¨‹

![image-20230313170152730](https://javaxiaobear-1301481032.cos.ap-guangzhou.myqcloud.com//picture-bed/image-20230313170152730.png)

## 3ã€ä¸ºä»€ä¹ˆéœ€è¦åºåˆ—åŒ–å’Œååºåˆ—åŒ–å‘¢ï¼Ÿ

å¤§å®¶å¯ä»¥å›å¿†ä¸€ä¸‹ï¼Œå¹³æ—¶éƒ½æ˜¯å¦‚æœå°†æ–‡å­—æ–‡ä»¶ã€å›¾ç‰‡æ–‡ä»¶ã€è§†é¢‘æ–‡ä»¶ã€è½¯ä»¶å®‰è£…åŒ…ç­‰ä¼ ç»™å°ä¼™ä¼´æ—¶ï¼Œè¿™äº›èµ„æºåœ¨è®¡ç®—æœºä¸­å­˜å‚¨çš„æ–¹å¼æ˜¯æ€æ ·çš„ã€‚
è¿›è€Œå†æ€è€ƒï¼ŒJava ä¸­çš„å¯¹è±¡å¦‚æœéœ€è¦å­˜å‚¨æˆ–è€…ä¼ è¾“åº”è¯¥é€šè¿‡ä»€ä¹ˆå½¢å¼å‘¢ï¼Ÿ

æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œä¸€ä¸ªæ–‡ä»¶é€šå¸¸æ˜¯ä¸€ä¸ª m ä¸ªå­—èŠ‚çš„åºåˆ—ï¼šB0, B1, â€¦, Bk, â€¦, Bm-1ã€‚æ‰€æœ‰çš„ I/O è®¾å¤‡ï¼ˆä¾‹å¦‚ç½‘ç»œã€ç£ç›˜å’Œç»ˆç«¯ï¼‰éƒ½è¢«æ¨¡å‹åŒ–ä¸ºæ–‡ä»¶ï¼Œè€Œæ‰€æœ‰çš„è¾“å…¥å’Œè¾“å‡ºéƒ½è¢«å½“ä½œå¯¹åº”æ–‡ä»¶çš„è¯»å’Œå†™æ¥æ‰§è¡Œã€‚

å› æ­¤æœ¬è´¨ä¸Šè®²ï¼Œæ–‡æœ¬æ–‡ä»¶ï¼Œå›¾ç‰‡ã€è§†é¢‘å’Œå®‰è£…åŒ…ç­‰æ–‡ä»¶åº•å±‚éƒ½è¢«è½¬åŒ–ä¸ºäºŒè¿›åˆ¶å­—èŠ‚æµæ¥ä¼ è¾“çš„ï¼Œå¯¹æ–¹å¾—æ–‡ä»¶å°±éœ€è¦å¯¹æ–‡ä»¶è¿›è¡Œè§£æï¼Œå› æ­¤å°±éœ€è¦æœ‰èƒ½å¤Ÿæ ¹æ®ä¸åŒçš„æ–‡ä»¶ç±»å‹æ¥è§£ç å‡ºæ–‡ä»¶çš„å†…å®¹çš„ç¨‹åºã€‚

å¤§å®¶è¯•æƒ³ä¸€ä¸ªå…¸å‹çš„åœºæ™¯ï¼šå¦‚æœè¦å®ç° Java è¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼Œå°±éœ€è¦å°†è°ƒç”¨ç»“æœé€šè¿‡ç½‘è·¯ä¼ è¾“ç»™è°ƒç”¨æ–¹ï¼Œå¦‚æœè°ƒç”¨æ–¹å’ŒæœåŠ¡æä¾›æ–¹ä¸åœ¨ä¸€å°æœºå™¨ä¸Šå°±å¾ˆéš¾å…±äº«å†…å­˜ï¼Œå°±éœ€è¦å°† Java å¯¹è±¡è¿›è¡Œä¼ è¾“ã€‚è€Œæƒ³è¦å°† Java ä¸­çš„å¯¹è±¡è¿›è¡Œç½‘ç»œä¼ è¾“æˆ–å­˜å‚¨åˆ°æ–‡ä»¶ä¸­ï¼Œå°±éœ€è¦å°†å¯¹è±¡è½¬åŒ–ä¸ºäºŒè¿›åˆ¶å­—èŠ‚æµï¼Œè¿™å°±æ˜¯æ‰€è°“çš„åºåˆ—åŒ–ã€‚å­˜å‚¨æˆ–ä¼ è¾“ä¹‹åå¿…ç„¶å°±éœ€è¦å°†äºŒè¿›åˆ¶æµè¯»å–å¹¶è§£ææˆ Java å¯¹è±¡ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„ååºåˆ—åŒ–ã€‚

==åºåˆ—åŒ–çš„ä¸»è¦ç›®çš„æ˜¯ï¼šæ–¹ä¾¿å­˜å‚¨åˆ°æ–‡ä»¶ç³»ç»Ÿã€æ•°æ®åº“ç³»ç»Ÿæˆ–ç½‘ç»œä¼ è¾“ç­‰ã€‚==



## 4ã€åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„ä½¿ç”¨åœºæ™¯

> - è¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼ˆRPCï¼‰çš„æ¡†æ¶é‡Œä¼šç”¨åˆ°åºåˆ—åŒ–
> - å°†å¯¹è±¡å­˜å‚¨åˆ°æ–‡ä»¶ä¸­æ—¶ï¼Œéœ€è¦ç”¨åˆ°åºåˆ—åŒ–
> - å°†å¯¹è±¡å­˜å‚¨åˆ°ç¼“å­˜æ•°æ®åº“ï¼ˆå¦‚ Redisï¼‰æ—¶éœ€è¦ç”¨åˆ°åºåˆ—åŒ–
> - é€šè¿‡åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„æ–¹å¼å®ç°å¯¹è±¡çš„æ·±æ‹·è´

## 5ã€å¸¸è§çš„åºåˆ—åŒ–æ–¹å¼

> å¸¸è§çš„åºåˆ—åŒ–æ–¹å¼åŒ…æ‹¬ Java åŸç”Ÿåºåˆ—åŒ–ã€Hessian åºåˆ—åŒ–ã€Kryo åºåˆ—åŒ–ã€JSON åºåˆ—åŒ–ç­‰ã€‚

### 1ã€JavaåŸç”Ÿåºåˆ—åŒ–

å­¦ä¹ çš„æœ€å¥½æ–¹å¼å°±æ˜¯æŸ¥çœ‹æºç ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥æŸ¥çœ‹ä¸€ä¸‹`Serializable`çš„æºç 

```java
public interface Serializable {  
}
```

æºç éå¸¸ç®€å•ï¼Œä»€ä¹ˆæ–¹æ³•éƒ½æ²¡æœ‰ï¼Œä½†æ˜¯æ³¨é‡Šå¾ˆé•¿ï¼Œå…¶æ ¸å¿ƒå°±æ˜¯ï¼š

- Java åŸç”Ÿåºåˆ—åŒ–éœ€è¦å®ç° Serializable æ¥å£ã€‚åºåˆ—åŒ–æ¥å£ä¸åŒ…å«ä»»ä½•æ–¹æ³•å’Œå±æ€§ç­‰ï¼Œå®ƒåªèµ·åˆ°åºåˆ—åŒ–æ ‡è¯†ä½œç”¨ã€‚
- ä¸€ä¸ªç±»å®ç°åºåˆ—åŒ–æ¥å£åˆ™å…¶å­ç±»å‹ä¹Ÿä¼šç»§æ‰¿åºåˆ—åŒ–èƒ½åŠ›ï¼Œä½†æ˜¯å®ç°åºåˆ—åŒ–æ¥å£çš„ç±»ä¸­æœ‰å…¶ä»–å¯¹è±¡çš„å¼•ç”¨ï¼Œåˆ™å…¶ä»–å¯¹è±¡ä¹Ÿè¦å®ç°åºåˆ—åŒ–æ¥å£ã€‚åºåˆ—åŒ–æ—¶å¦‚æœæŠ›å‡º NotSerializableException å¼‚å¸¸ï¼Œè¯´æ˜è¯¥å¯¹è±¡æ²¡æœ‰å®ç° Serializable æ¥å£ã€‚
- æ¯ä¸ªåºåˆ—åŒ–ç±»éƒ½æœ‰ä¸€ä¸ªå« serialVersionUID çš„ç‰ˆæœ¬å·ï¼Œååºåˆ—åŒ–æ—¶ä¼šæ ¡éªŒå¾…åå°„çš„ç±»çš„åºåˆ—åŒ–ç‰ˆæœ¬å·å’ŒåŠ è½½çš„åºåˆ—åŒ–å­—èŠ‚æµä¸­çš„ç‰ˆæœ¬å·æ˜¯å¦ä¸€è‡´ï¼Œå¦‚æœåºåˆ—åŒ–å·ä¸ä¸€è‡´åˆ™ä¼šæŠ›å‡º InvalidClassException å¼‚å¸¸ã€‚
- å¼ºçƒˆæ¨èæ¯ä¸ªåºåˆ—åŒ–ç±»éƒ½æ‰‹åŠ¨æŒ‡å®šå…¶ serialVersionUID ï¼Œå¦‚æœä¸æ‰‹åŠ¨æŒ‡å®šï¼Œé‚£ä¹ˆç¼–è¯‘å™¨ä¼šåŠ¨æ€ç”Ÿæˆé»˜è®¤çš„åºåˆ—åŒ–å·ï¼Œå› ä¸ºè¿™ä¸ªé»˜è®¤çš„åºåˆ—åŒ–å·å’Œç±»çš„ç‰¹å¾ä»¥åŠç¼–è¯‘å™¨çš„å®ç°éƒ½æœ‰å…³ç³»ï¼Œå¾ˆå®¹æ˜“åœ¨ååºåˆ—åŒ–æ—¶æŠ›å‡º InvalidClassException å¼‚å¸¸ã€‚**å»ºè®®å°†è¿™ä¸ªåºåˆ—åŒ–ç‰ˆæœ¬å·å£°æ˜ä¸ºç§æœ‰ï¼Œä»¥é¿å…è¿è¡Œæ—¶è¢«ä¿®æ”¹**ã€‚
- å®ç°åºåˆ—åŒ–æ¥å£çš„ç±»å¯ä»¥æä¾›è‡ªå®šä¹‰çš„å‡½æ•°ä¿®æ”¹é»˜è®¤çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–è¡Œä¸ºã€‚

ä¸Šé¢æ³¨é‡Šä¹Ÿè¯´æ˜ï¼Œå»ºè®®åºåˆ—åŒ–ç‰ˆæœ¬å·å£°æ˜ä¸ºç§æœ‰ï¼Œä»¥é¿å…è¿è¡Œæ—¶è¢«ä¿®æ”¹ã€‚

å¦‚æœä¸€ä¸ªç±»æ–‡ä»¶åºåˆ—åŒ–åˆ°æ–‡ä»¶åï¼Œç±»çš„ç»“æ„å‘ç”Ÿäº†æ”¹å˜ï¼Œæ˜¯å¦èƒ½è¢«æ­£ç¡®çš„ååºåˆ—åŒ–ï¼Ÿ

> è¿™ä¸ªç­”æ¡ˆæ˜¯ä¸ç¡®å®šçš„ã€‚
> é€šå¸¸æˆ‘ä»¬æ˜¯é€šè¿‡åŠ å¯†ç®—æ³•å¯¹æ–‡ä»¶è¿›è¡Œå‰é¢ï¼Œæ ¹æ®ç­¾ååˆ¤æ–­æ–‡ä»¶æ˜¯å¦è¢«ä¿®æ”¹ï¼›ä½†Javaåºåˆ—åŒ–çš„åœºæ™¯å¹¶ä¸é€‚ç”¨äºä¸Šè¿°çš„æ–¹æ¡ˆï¼Œå¦‚æœåœ¨ç±»æ–‡ä»¶çš„æŸä¸ªåœ°æ–¹åŠ ä¸ªç©ºæ ¼ï¼Œæ‰§è¡Œç­‰ç¬¦å·ç±»çš„ç»“æ„ï¼Œæ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œè¿™ä¸ªæ—¶å€™ç­¾åå°±ä¸åº”è¯¥å‘ç”Ÿå˜ï¼›è¿˜æœ‰ä¸€ä¸ªç±»æ–°å¢ä¸€ä¸ªå±æ€§ï¼Œä¹‹å‰çš„å±æ€§éƒ½æ˜¯æœ‰å€¼çš„ï¼Œä¹‹å‰éƒ½è¢«åºåˆ—åŒ–åˆ°å¯¹è±¡æ–‡ä»¶ä¸­ï¼Œæœ‰äº›åœºæ™¯ä¸‹è¿˜å¸Œæœ›ååºåˆ—åŒ–æ—¶å¯ä»¥æ­£å¸¸è§£æï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ

åºåˆ—åŒ–æµ‹è¯•ä»£ç ï¼š

```java
public class SerializationTest {  
    public static void main(String[] args) throws IOException {  
        ByteArrayOutputStream buffer = new ByteArrayOutputStream();  
        try (ObjectOutputStream output = new ObjectOutputStream(buffer)) {  
            // å†™å…¥byte:  
            output.writeBytes("å°ç†Šå­¦Java");  
            // å†™å…¥String:  
            output.writeUTF("Hello");  
            // å†™å…¥Object:  
            output.writeObject("javaxiaobear");  
        }  
        System.out.println(Arrays.toString(buffer.toByteArray()));  
    }  
}
```

### 2ã€Hessian åºåˆ—åŒ–

> Hessian æ˜¯ä¸€ä¸ªåŠ¨æ€ç±»å‹ï¼ŒäºŒè¿›åˆ¶åºåˆ—åŒ–ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªåŸºäºå¯¹è±¡ä¼ è¾“çš„ç½‘ç»œåè®®ã€‚Hessian æ˜¯ä¸€ç§è·¨è¯­è¨€çš„åºåˆ—åŒ–æ–¹æ¡ˆï¼Œåºåˆ—åŒ–åçš„å­—èŠ‚æ•°æ›´å°‘ï¼Œæ•ˆç‡æ›´é«˜ã€‚Hessian åºåˆ—åŒ–ä¼šæŠŠå¤æ‚å¯¹è±¡çš„å±æ€§æ˜ å°„åˆ° Map ä¸­å†è¿›è¡Œåºåˆ—åŒ–ã€‚
> å®˜æ–¹ä»‹ç»ğŸ‘‰[Hessian 2.0 Serialization Protocol](https://link.juejin.cn/?target=http%3A%2F%2Fhessian.caucho.com%2Fdoc%2Fhessian-serialization.html "http://hessian.caucho.com/doc/hessian-serialization.html")

å’ŒJDKè‡ªå¸¦çš„åºåˆ—åŒ–æ–¹å¼ç±»ä¼¼ï¼ŒHessiané‡‡ç”¨çš„ä¹Ÿæ˜¯äºŒè¿›åˆ¶åè®®ï¼Œåªä¸è¿‡Hessianåºåˆ—åŒ–ä¹‹åï¼Œå­—èŠ‚æ•°æ›´å°ï¼Œæ€§èƒ½æ›´ä¼˜ã€‚ç›®å‰Hessianå·²ç»å‡ºåˆ°2.0ç‰ˆæœ¬ï¼Œç›¸è¾ƒäº1.0çš„Hessianæ€§èƒ½æ›´ä¼˜ã€‚ç›¸è¾ƒäºJDKè‡ªå¸¦çš„åºåˆ—åŒ–ï¼ŒHessiançš„è®¾è®¡ç›®æ ‡æ›´æ˜ç¡®ğŸ‘‡

Hessian æ˜¯åŠ¨æ€ç±»å‹çš„ã€ç´§å‡‘çš„ï¼Œå¹¶ä¸”å¯ä»¥è·¨è¯­è¨€ç§»æ¤ã€‚Hessian åè®®æœ‰ä»¥ä¸‹è®¾è®¡ç›®æ ‡ï¼š

- å®ƒå¿…é¡»æ˜¯å•æ¬¡å¯è¯»æˆ–å¯å†™çš„ã€‚
- å®ƒå¿…é¡»å°½å¯èƒ½ç´§å‡‘ã€‚
- å®ƒå¿…é¡»ç®€å•ï¼Œä»¥ä¾¿å¯ä»¥æœ‰æ•ˆåœ°æµ‹è¯•å’Œå®æ–½ã€‚
- å®ƒå¿…é¡»å°½å¯èƒ½å¿«ã€‚
- å®ƒå¿…é¡»æ”¯æŒ Unicode å­—ç¬¦ä¸²ã€‚
- å®ƒå¿…é¡»æ”¯æŒ 8 ä½äºŒè¿›åˆ¶æ•°æ®è€Œä¸è½¬ä¹‰æˆ–ä½¿ç”¨é™„ä»¶ã€‚
- å®ƒå¿…é¡»æ”¯æŒåŠ å¯†ã€å‹ç¼©ã€ç­¾åå’Œäº‹åŠ¡ä¸Šä¸‹æ–‡ä¿¡å°ã€‚

Hessiançš„åºåˆ—åŒ–é€Ÿåº¦ç›¸è¾ƒäºJDKåºåˆ—åŒ–æ‰æ›´å¿«ã€‚åªä¸è¿‡Javaåºåˆ—åŒ–ä¼šæŠŠè¦åºåˆ—åŒ–çš„å¯¹è±¡ç±»çš„å…ƒæ•°æ®å’Œä¸šåŠ¡æ•°æ®å…¨éƒ¨åºåˆ—åŒ–ä»å­—èŠ‚æµï¼Œå¹¶ä¸”ä¼šä¿ç•™å®Œæ•´çš„ç»§æ‰¿å…³ç³»ï¼Œå› æ­¤ç›¸è¾ƒäºHessianåºåˆ—åŒ–æ›´åŠ å¯é ã€‚

ä¸è¿‡ç›¸è¾ƒäºJDKçš„åºåˆ—åŒ–ï¼ŒHessianå¦ä¸€ä¸ªä¼˜åŠ¿åœ¨äºï¼Œè¿™æ˜¯ä¸€ä¸ªè·¨è¯­è¨€çš„åºåˆ—åŒ–æ–¹å¼ï¼Œè¿™æ„å‘³ç€åºåˆ—åŒ–åçš„æ•°æ®å¯ä»¥è¢«å…¶ä»–è¯­è¨€ä½¿ç”¨ï¼Œå…¼å®¹æ€§æ›´å¥½ã€‚

**åŸºç¡€ä½¿ç”¨**

å¼•å…¥pomä¾èµ–

```xml
<!-- https://mvnrepository.com/artifact/com.caucho/hessian -->  
<dependency>  
    <groupId>com.caucho</groupId>  
    <artifactId>hessian</artifactId>  
    <version>4.0.65</version>  
</dependency>
```

**ä¸æœï¼Œå’±è·‘ä¸ªåˆ†**

```java
public class SerializationTest {  
    public static void main(String[] args) throws IOException {  
        String javaxiaobear = "å°ç†Šå­¦Java";  
        System.out.println("JDKåºåˆ—åŒ–é•¿åº¦ï¼š" + jdkSerialize(javaxiaobear).length);  
        System.out.println("hessianåºåˆ—åŒ–é•¿åº¦ï¼š" + hessianSerialize(javaxiaobear).length);  
    }  
  
    /**  
     * jdkåºåˆ—åŒ–æµ‹è¯•  
     * @param str  
     * @return  
     * @param <T>  
     */  
    public static <T> byte[] jdkSerialize(T str){  
        byte[] data = null;  
        try{  
            ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();  
            ObjectOutputStream output = new ObjectOutputStream(byteArrayOutputStream);  
            output.writeObject(str);  
            output.flush();  
            output.close();  
            data = byteArrayOutputStream.toByteArray();  
        }catch (Exception e){  
            e.printStackTrace();  
        }  
        return data;  
    }  
  
  
  
    /**  
     * hessianåºåˆ—åŒ–æµ‹è¯•  
     * @param str  
     * @return  
     * @param <T>  
     */  
    public static <T> byte[] hessianSerialize(T str){  
        byte[] data = null;  
        try{  
            ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();  
            Hessian2Output output = new Hessian2Output(byteArrayOutputStream);  
            output.writeObject(str);  
            output.flush();  
            output.close();  
            data = byteArrayOutputStream.toByteArray();  
        }catch (Exception e){  
            e.printStackTrace();  
        }  
        return data;  
    }  
}
```

è¾“å‡ºç»“æœï¼š
//JDKåºåˆ—åŒ–é•¿åº¦ï¼š20
//hessianåºåˆ—åŒ–é•¿åº¦ï¼š14

### 3ã€Kryo åºåˆ—åŒ–

> Kryo æ˜¯ä¸€ä¸ªå¿«é€Ÿé«˜æ•ˆçš„ Java åºåˆ—åŒ–å’Œå…‹éš†å·¥å…·ã€‚Kryo çš„ç›®æ ‡æ˜¯å¿«é€Ÿã€å­—èŠ‚å°‘å’Œæ˜“ç”¨ã€‚Kryo è¿˜å¯ä»¥è‡ªåŠ¨è¿›è¡Œæ·±æ‹·è´æˆ–è€…æµ…æ‹·è´ã€‚Kryo çš„æ‹·è´æ˜¯å¯¹è±¡åˆ°å¯¹è±¡çš„æ‹·è´è€Œä¸æ˜¯å¯¹è±¡åˆ°å­—èŠ‚ï¼Œå†ä»å­—èŠ‚åˆ°å¯¹è±¡çš„æ¢å¤ã€‚Kryo ä¸ºäº†ä¿è¯åºåˆ—åŒ–çš„é«˜æ•ˆç‡ï¼Œä¼šæå‰åŠ è½½éœ€è¦çš„ç±»ï¼Œè¿™ä¼šå¸¦ä¸€äº›æ¶ˆè€—ï¼Œä½†æ˜¯è¿™æ˜¯åºåˆ—åŒ–åæ–‡ä»¶è¾ƒå°ä¸”ååºåˆ—åŒ–éå¸¸å¿«çš„é‡è¦åŸå› ã€‚
> å®˜æ–¹åœ°å€ï¼š[kryo](https://github.com/EsotericSoftware/kryo)

**åŸºç¡€ä½¿ç”¨**
è¿™é‡Œåªä½œä¸ºåŸºç¡€ä½¿ç”¨ï¼Œä¸ä½œä¸ºé‡ç‚¹è®²è§£ï¼Œéœ€è¦äº†è§£çš„å¯ä»¥å»æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£å“ˆ

- å¼•å…¥pomä¾èµ–ï¼Œè¿™é‡Œéœ€è¦JDK11ç¼–è¯‘å“¦

```xml
<dependency>
   <groupId>com.esotericsoftware</groupId>
   <artifactId>kryo</artifactId>
   <version>5.4.0</version>
</dependency>
```

æµ‹è¯•demo

```java
public static void main(String[] args) throws IOException {  
    String javaxiaobear = "å°ç†Šå­¦Java";  
    System.out.println("JDKåºåˆ—åŒ–é•¿åº¦ï¼š" + jdkSerialize(javaxiaobear).length);  
    System.out.println("hessianåºåˆ—åŒ–é•¿åº¦ï¼š" + hessianSerialize(javaxiaobear).length);  
    User user = new User("å°ç†Šå­¦Java");  
    byte[] bytes = kryoSerialize(user);  
    System.out.println("kryoåºåˆ—åŒ–çš„é•¿åº¦ï¼š" + bytes.length);  
 
}
/**  
 * kryoåºåˆ—åŒ–  
 * @param user  
 * @return  
 */  
public static byte[] kryoSerialize(User user) {  
    Kryo kryo = new Kryo();  
    kryo.register(user.getClass());  
    ByteArrayOutputStream bos = new ByteArrayOutputStream();  
    Output output = new Output(bos);  
    //å†™å…¥nullæ—¶ä¼šæŠ¥é”™  
    kryo.writeObject(output,user);  
    output.close();  
    return bos.toByteArray();  
}
```

ç»“æœï¼škryoåºåˆ—åŒ–çš„é•¿åº¦ï¼š14

### 4ã€JSON åºåˆ—åŒ–

> JSON (JavaScript Object Notation) æ˜¯ä¸€ç§è½»é‡çº§çš„æ•°æ®äº¤æ¢æ–¹å¼ã€‚JSON åºåˆ—åŒ–æ˜¯åŸºäº JSON è¿™ç§ç»“æ„æ¥å®ç°çš„ã€‚JSON åºåˆ—åŒ–å°†å¯¹è±¡è½¬åŒ–æˆ JSON å­—ç¬¦ä¸²ï¼ŒJSON ååºåˆ—åŒ–åˆ™æ˜¯å°† JSON å­—ç¬¦ä¸²è½¬å›å¯¹è±¡çš„è¿‡ç¨‹ã€‚å¸¸ç”¨çš„JSON åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„åº“æœ‰ Jacksonã€GSONã€Fastjson ç­‰ã€‚

#### 1ã€GSON

> ã€€ã€€Gsonæä¾›äº†fromJson() å’ŒtoJson() ä¸¤ä¸ªç›´æ¥ç”¨äºè§£æå’Œç”Ÿæˆçš„æ–¹æ³•ï¼Œå‰è€…å®ç°ååºåˆ—åŒ–ï¼Œåè€…å®ç°äº†åºåˆ—åŒ–ï¼›åŒæ—¶æ¯ä¸ªæ–¹æ³•éƒ½æä¾›äº†é‡è½½æ–¹æ³•ã€‚

è·‘ä¸ªdemo

```java
/**
 * Gson åºåˆ—åŒ– ä¸ååºåˆ—åŒ–
 * @param user
 */
public static void gsonSerialize(User user){
    //gsonåºåˆ—åŒ–
    String userJson = new Gson().toJson(user);
    System.out.println("gsonåºåˆ—åŒ–åçš„å€¼ï¼š" + userJson);
    //gsonååºåˆ—åŒ–
    User user1 = new Gson().fromJson(userJson, User.class);
    System.out.println("gsonååºåˆ—åŒ–åï¼š" + user1.toString());
}
```

## 6ã€Java å¸¸è§çš„åºåˆ—åŒ–æ–¹æ¡ˆå¯¹æ¯”

> å®éªŒçš„ç‰ˆæœ¬ï¼škryo-shaded ä½¿ç”¨ 5.4.0ç‰ˆæœ¬ï¼Œgson ä½¿ç”¨ 2.8.5 ç‰ˆæœ¬ï¼Œhessian ç”¨ `4.0.65` ç‰ˆæœ¬ã€‚
> å®éªŒçš„æ•°æ®ï¼šæ„é€  50 ä¸‡ User å¯¹è±¡è¿è¡Œå¤šæ¬¡ã€‚
> å¤§è‡´å¾—å‡ºä¸€ä¸ªç»“è®ºï¼š
>
> - ä»äºŒè¿›åˆ¶æµå¤§å°æ¥è®²ï¼šJSON åºåˆ—åŒ– > Java åºåˆ—åŒ– > Hessian2 åºåˆ—åŒ– > Kryo åºåˆ—åŒ– > Kryo åºåˆ—åŒ–æ³¨å†Œæ¨¡å¼ï¼›
>
> - ä»åºåˆ—åŒ–è€—æ—¶è€Œè¨€æ¥è®²ï¼šGSON åºåˆ—åŒ– > Java åºåˆ—åŒ– > Kryo åºåˆ—åŒ– > Hessian2 åºåˆ—åŒ– > Kryo åºåˆ—åŒ–æ³¨å†Œæ¨¡å¼ï¼›
>
> - ä»ååºåˆ—åŒ–è€—æ—¶è€Œè¨€æ¥è®²ï¼šGSON åºåˆ—åŒ– > Java åºåˆ—åŒ– > Hessian2 åºåˆ—åŒ– > Kryo åºåˆ—åŒ–æ³¨å†Œæ¨¡å¼ > Kryoåºåˆ—åŒ–ï¼›
>
>   ä»æ€»è€—æ—¶è€Œè¨€ï¼šKryo åºåˆ—åŒ–æ³¨å†Œæ¨¡å¼è€—æ—¶æœ€çŸ­ã€‚

## 7ã€åºåˆ—åŒ–å¼•å‘çš„ä¸€ä¸ªè¡€æ¡ˆ

æˆ‘ä»¬çœ‹ä¸‹é¢çš„ä¸€ä¸ªæ¡ˆä¾‹

> å‰ç«¯è°ƒç”¨æœåŠ¡ Aï¼ŒæœåŠ¡ A è°ƒç”¨æœåŠ¡ Bï¼ŒæœåŠ¡ B é¦–æ¬¡æ¥åˆ°è¯·æ±‚ä¼šæŸ¥ DBï¼Œç„¶åç¼“å­˜åˆ° Redisï¼ˆç¼“å­˜ 1 ä¸ªå°æ—¶ï¼‰ã€‚æœåŠ¡ A æ ¹æ®æœåŠ¡ B è¿”å›çš„æ•°æ®åæ‰§è¡Œä¸€äº›å¤„ç†é€»è¾‘ï¼Œå¤„ç†åå½¢æˆæ–°çš„å¯¹è±¡å­˜åˆ° Redisï¼ˆç¼“å­˜ 2 ä¸ªå°æ—¶ï¼‰ã€‚æœåŠ¡ A é€šè¿‡ Dubbo æ¥è°ƒç”¨æœåŠ¡ Bï¼ŒA å’Œ B ä¹‹é—´æ•°æ®é€šè¿‡ Map<String,Object> ç±»å‹ä¼ è¾“ï¼ŒæœåŠ¡ B ä½¿ç”¨Fastjson æ¥å®ç° JSON çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚
>
> æœåŠ¡ B çš„æ¥å£è¿”å›çš„ Map å€¼ä¸­å­˜åœ¨ä¸€ä¸ª Long ç±»å‹çš„ id å­—æ®µï¼ŒæœåŠ¡ A è·å–åˆ° Map ï¼Œå–å‡º id å­—æ®µå¹¶å¼ºè½¬ä¸º Long ç±»å‹ä½¿ç”¨ã€‚

æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š![image-20230508101523536](https://javaxiaobear-1301481032.cos.ap-guangzhou.myqcloud.com//picture-bed/image-20230508101523536.png)

é€šè¿‡åˆ†ææˆ‘ä»¬å‘ç°ï¼ŒæœåŠ¡ A å’ŒæœåŠ¡ B çš„ RPC è°ƒç”¨ä½¿ç”¨ Java åºåˆ—åŒ–ï¼Œå› æ­¤ç±»å‹ä¿¡æ¯ä¸ä¼šä¸¢å¤±ã€‚

ä½†æ˜¯ç”±äºæœåŠ¡ B é‡‡ç”¨ JSON åºåˆ—åŒ–è¿›è¡Œç¼“å­˜ï¼Œç¬¬ä¸€æ¬¡è®¿é—®æ²¡å•¥é—®é¢˜ï¼Œå…¶æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š

![image-20230508101609338](https://javaxiaobear-1301481032.cos.ap-guangzhou.myqcloud.com//picture-bed/image-20230508101609338.png)

å¦‚æœæœåŠ¡ Aå¼€å¯äº†ç¼“å­˜ ï¼ŒæœåŠ¡ A åœ¨ç¬¬ä¸€æ¬¡è¯·æ±‚æœåŠ¡ B åï¼Œç¼“å­˜äº†è¿ç®—ç»“æœï¼Œä¸”æœåŠ¡ A ç¼“å­˜æ—¶é—´æ¯”æœåŠ¡ B é•¿ï¼Œå› æ­¤ä¸ä¼šå‡ºç°é”™è¯¯ã€‚

![image-20230508101637281](https://javaxiaobear-1301481032.cos.ap-guangzhou.myqcloud.com//picture-bed/image-20230508101637281.png)

å¦‚æœæœåŠ¡ A ä¸å¼€å¯ç¼“å­˜ ï¼ŒæœåŠ¡ A ä¼šè¯·æ±‚æœåŠ¡ B ï¼Œç”±äºé¦–æ¬¡è¯·æ±‚æ—¶ï¼ŒæœåŠ¡ B å·²ç»ç¼“å­˜äº†æ•°æ®ï¼ŒæœåŠ¡ B ä»Redisï¼ˆBï¼‰ä¸­ååºåˆ—åŒ–å¾—åˆ° Map ã€‚æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![image-20230508101705354](https://javaxiaobear-1301481032.cos.ap-guangzhou.myqcloud.com//picture-bed/image-20230508101705354.png)

ç„¶è€Œé—®é¢˜æ¥äº†ï¼š æœåŠ¡ A ä» Map å–å‡ºæ­¤ Id å­—æ®µï¼Œå¼ºè½¬ä¸º Long æ—¶ä¼šå‡ºç°ç±»å‹è½¬æ¢å¼‚å¸¸ã€‚

æœ€åå®šä½åˆ°åŸå› æ˜¯ Json ååºåˆ—åŒ– Map æ—¶å¦‚æœåŸå§‹å€¼å°äº Int æœ€å¤§å€¼ï¼Œååºåˆ—åŒ–ååŸæœ¬ä¸º Long ç±»å‹çš„å­—æ®µï¼Œå˜ä¸ºäº† Integer ç±»å‹ï¼ŒæœåŠ¡ B çš„åŒå­¦ç´§æ€¥ä¿®å¤ã€‚

æœåŠ¡ A å¼€å¯ç¼“å­˜æ—¶ï¼Œ è™½ç„¶é‡‡ç”¨äº† JSON åºåˆ—åŒ–å­˜å…¥ç¼“å­˜ï¼Œä½†æ˜¯é‡‡ç”¨ DTO å¯¹è±¡è€Œä¸æ˜¯ Map æ¥å­˜æ”¾å±æ€§ï¼Œæ‰€ä»¥JSON ååºåˆ—åŒ–æ²¡æœ‰é—®é¢˜ã€‚
å› æ­¤å¤§å®¶ä½¿ç”¨äºŒæ–¹æˆ–è€…ä¸‰æ–¹æœåŠ¡æ—¶ï¼Œå½“å¯¹æ–¹è¿”å›çš„æ˜¯ Map<String,Object> ç±»å‹çš„æ•°æ®æ—¶è¦ç‰¹åˆ«æ³¨æ„è¿™ä¸ªé—®é¢˜ã€‚

> ä½œä¸ºæœåŠ¡æä¾›æ–¹ï¼Œå¯ä»¥é‡‡ç”¨ JDK æˆ–è€… Hessian ç­‰åºåˆ—åŒ–æ–¹å¼ï¼›
>
> ä½œä¸ºæœåŠ¡çš„ä½¿ç”¨æ–¹ï¼Œæˆ‘ä»¬ä¸è¦ä» Map ä¸­ä¸€ä¸ªå­—æ®µä¸€ä¸ªå­—æ®µè·å–å’Œè½¬æ¢ï¼Œå¯ä»¥ä½¿ç”¨ JSON åº“ç›´æ¥å°† Map æ˜ å°„æˆæ‰€éœ€çš„å¯¹è±¡ï¼Œè¿™æ ·åšä¸ä»…ä»£ç æ›´ç®€æ´è¿˜å¯ä»¥é¿å…å¼ºè½¬å¤±è´¥ã€‚

æ¥ä¸ªdemo

```java
@Test
public void testFastJsonObject() {
    Map<String, Object> map = new HashMap<>();
    final String name = "name";
    final String id = "id";
    map.put(name, "å¼ ä¸‰");
    map.put(id, 20L);
    String fastJsonString = FastJsonUtil.getJsonString(map);
    // æ¨¡æ‹Ÿæ‹¿åˆ°æœåŠ¡Bçš„æ•°æ®
    Map<String, Object> mapFastJson = FastJsonUtil.parseJson(fastJsonString,map.getClass());
    // è½¬æˆå¼ºç±»å‹å±æ€§çš„å¯¹è±¡è€Œä¸æ˜¯ä½¿ç”¨map å•ä¸ªå–å€¼
    User user = new JSONObject(mapFastJson).toJavaObject(User.class);
    // æ­£ç¡®
    Assert.assertEquals(map.get(name), user.getName());
    // æ­£ç¡®
    Assert.assertEquals(map.get(id), user.getId());
}
```

## 8ã€æ€»ç»“

> ä¸»è¦æè¿°äº†Javaåºåˆ—åŒ–çš„åœºæ™¯å’Œä½¿ç”¨ï¼Œä»¥åŠæ¡ˆä¾‹åˆ†æï¼Œåœ¨å¼€å‘ä¸­æˆ‘ä»¬è¿˜æ˜¯è¦æ³¨æ„ç»†èŠ‚ï¼Œé¿å¼€è¶Ÿå‘ï¼